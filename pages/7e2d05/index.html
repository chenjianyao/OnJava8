<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用枚举类型替代整型常量 | 一席之地</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/OnJava8/img/favicon.ico">
    <meta name="description" content="技术博客,专注Java后端学习与总结。Java,Spring等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/OnJava8/assets/css/0.styles.ad933ae4.css" as="style"><link rel="preload" href="/OnJava8/assets/js/app.bd93526c.js" as="script"><link rel="preload" href="/OnJava8/assets/js/2.e7971354.js" as="script"><link rel="preload" href="/OnJava8/assets/js/86.e2c729bd.js" as="script"><link rel="prefetch" href="/OnJava8/assets/js/10.aab10d07.js"><link rel="prefetch" href="/OnJava8/assets/js/100.6a76afaf.js"><link rel="prefetch" href="/OnJava8/assets/js/101.8cfd52aa.js"><link rel="prefetch" href="/OnJava8/assets/js/102.d7fc1dd6.js"><link rel="prefetch" href="/OnJava8/assets/js/103.62e6389e.js"><link rel="prefetch" href="/OnJava8/assets/js/104.ec3c745e.js"><link rel="prefetch" href="/OnJava8/assets/js/105.0176bd1d.js"><link rel="prefetch" href="/OnJava8/assets/js/106.0beb0506.js"><link rel="prefetch" href="/OnJava8/assets/js/107.37540438.js"><link rel="prefetch" href="/OnJava8/assets/js/108.35a13d77.js"><link rel="prefetch" href="/OnJava8/assets/js/109.2b6301f8.js"><link rel="prefetch" href="/OnJava8/assets/js/11.a4d04d08.js"><link rel="prefetch" href="/OnJava8/assets/js/110.4fcddbf4.js"><link rel="prefetch" href="/OnJava8/assets/js/111.128ce7dd.js"><link rel="prefetch" href="/OnJava8/assets/js/112.03cc4176.js"><link rel="prefetch" href="/OnJava8/assets/js/113.7c9aac72.js"><link rel="prefetch" href="/OnJava8/assets/js/114.cd16da1e.js"><link rel="prefetch" href="/OnJava8/assets/js/115.1d789ca1.js"><link rel="prefetch" href="/OnJava8/assets/js/116.d8969f90.js"><link rel="prefetch" href="/OnJava8/assets/js/117.039b29bf.js"><link rel="prefetch" href="/OnJava8/assets/js/118.374747a2.js"><link rel="prefetch" href="/OnJava8/assets/js/119.e5149e17.js"><link rel="prefetch" href="/OnJava8/assets/js/12.d4a19bab.js"><link rel="prefetch" href="/OnJava8/assets/js/120.0fab4d32.js"><link rel="prefetch" href="/OnJava8/assets/js/121.87f7f390.js"><link rel="prefetch" href="/OnJava8/assets/js/122.6400d6fd.js"><link rel="prefetch" href="/OnJava8/assets/js/123.66ef8f99.js"><link rel="prefetch" href="/OnJava8/assets/js/124.af5d1549.js"><link rel="prefetch" href="/OnJava8/assets/js/125.5dc2b538.js"><link rel="prefetch" href="/OnJava8/assets/js/126.33709ca8.js"><link rel="prefetch" href="/OnJava8/assets/js/127.1d27f64b.js"><link rel="prefetch" href="/OnJava8/assets/js/128.df1f0a0f.js"><link rel="prefetch" href="/OnJava8/assets/js/129.2bfc6cc2.js"><link rel="prefetch" href="/OnJava8/assets/js/13.61f81ba0.js"><link rel="prefetch" href="/OnJava8/assets/js/130.8480463e.js"><link rel="prefetch" href="/OnJava8/assets/js/131.89a24a8b.js"><link rel="prefetch" href="/OnJava8/assets/js/132.b1061e40.js"><link rel="prefetch" href="/OnJava8/assets/js/133.4d9bc90c.js"><link rel="prefetch" href="/OnJava8/assets/js/134.c391790b.js"><link rel="prefetch" href="/OnJava8/assets/js/135.167ac455.js"><link rel="prefetch" href="/OnJava8/assets/js/136.020dccf9.js"><link rel="prefetch" href="/OnJava8/assets/js/137.23c6903f.js"><link rel="prefetch" href="/OnJava8/assets/js/138.3b6b99ca.js"><link rel="prefetch" href="/OnJava8/assets/js/139.777c122b.js"><link rel="prefetch" href="/OnJava8/assets/js/14.726776ee.js"><link rel="prefetch" href="/OnJava8/assets/js/140.6d7e858a.js"><link rel="prefetch" href="/OnJava8/assets/js/141.714c04b2.js"><link rel="prefetch" href="/OnJava8/assets/js/142.bd9ba292.js"><link rel="prefetch" href="/OnJava8/assets/js/143.1f83042a.js"><link rel="prefetch" href="/OnJava8/assets/js/144.6595f82d.js"><link rel="prefetch" href="/OnJava8/assets/js/145.7d7f4a74.js"><link rel="prefetch" href="/OnJava8/assets/js/15.1b581397.js"><link rel="prefetch" href="/OnJava8/assets/js/16.46e809c9.js"><link rel="prefetch" href="/OnJava8/assets/js/17.191c740d.js"><link rel="prefetch" href="/OnJava8/assets/js/18.48f57c2b.js"><link rel="prefetch" href="/OnJava8/assets/js/19.658ae315.js"><link rel="prefetch" href="/OnJava8/assets/js/20.8527c7ad.js"><link rel="prefetch" href="/OnJava8/assets/js/21.27e490d9.js"><link rel="prefetch" href="/OnJava8/assets/js/22.ec35fcb7.js"><link rel="prefetch" href="/OnJava8/assets/js/23.8433c799.js"><link rel="prefetch" href="/OnJava8/assets/js/24.dcd9cfa0.js"><link rel="prefetch" href="/OnJava8/assets/js/25.dd75b357.js"><link rel="prefetch" href="/OnJava8/assets/js/26.daa823b8.js"><link rel="prefetch" href="/OnJava8/assets/js/27.9f527b4e.js"><link rel="prefetch" href="/OnJava8/assets/js/28.43363c2c.js"><link rel="prefetch" href="/OnJava8/assets/js/29.5e92a14a.js"><link rel="prefetch" href="/OnJava8/assets/js/3.0514f807.js"><link rel="prefetch" href="/OnJava8/assets/js/30.3352e224.js"><link rel="prefetch" href="/OnJava8/assets/js/31.33ac669c.js"><link rel="prefetch" href="/OnJava8/assets/js/32.9e23ac2b.js"><link rel="prefetch" href="/OnJava8/assets/js/33.abb06d42.js"><link rel="prefetch" href="/OnJava8/assets/js/34.dd0e16b7.js"><link rel="prefetch" href="/OnJava8/assets/js/35.d9df3372.js"><link rel="prefetch" href="/OnJava8/assets/js/36.80d598f5.js"><link rel="prefetch" href="/OnJava8/assets/js/37.3bbde3ba.js"><link rel="prefetch" href="/OnJava8/assets/js/38.ef3e8fef.js"><link rel="prefetch" href="/OnJava8/assets/js/39.a0524b00.js"><link rel="prefetch" href="/OnJava8/assets/js/4.f06af0e8.js"><link rel="prefetch" href="/OnJava8/assets/js/40.6d19afc5.js"><link rel="prefetch" href="/OnJava8/assets/js/41.4b6f2684.js"><link rel="prefetch" href="/OnJava8/assets/js/42.ebbb17a6.js"><link rel="prefetch" href="/OnJava8/assets/js/43.0bf0ee64.js"><link rel="prefetch" href="/OnJava8/assets/js/44.fef38f9d.js"><link rel="prefetch" href="/OnJava8/assets/js/45.c740b76a.js"><link rel="prefetch" href="/OnJava8/assets/js/46.89fea2c6.js"><link rel="prefetch" href="/OnJava8/assets/js/47.9abab0ea.js"><link rel="prefetch" href="/OnJava8/assets/js/48.0938223f.js"><link rel="prefetch" href="/OnJava8/assets/js/49.1cd1f4f9.js"><link rel="prefetch" href="/OnJava8/assets/js/5.e6c3a840.js"><link rel="prefetch" href="/OnJava8/assets/js/50.ea7995af.js"><link rel="prefetch" href="/OnJava8/assets/js/51.a04f4f39.js"><link rel="prefetch" href="/OnJava8/assets/js/52.43f57018.js"><link rel="prefetch" href="/OnJava8/assets/js/53.e9a50590.js"><link rel="prefetch" href="/OnJava8/assets/js/54.ab23870c.js"><link rel="prefetch" href="/OnJava8/assets/js/55.0e35582c.js"><link rel="prefetch" href="/OnJava8/assets/js/56.452e8953.js"><link rel="prefetch" href="/OnJava8/assets/js/57.9dd0584b.js"><link rel="prefetch" href="/OnJava8/assets/js/58.787a4dfe.js"><link rel="prefetch" href="/OnJava8/assets/js/59.2cab4f91.js"><link rel="prefetch" href="/OnJava8/assets/js/6.3ef9bbef.js"><link rel="prefetch" href="/OnJava8/assets/js/60.efe46fee.js"><link rel="prefetch" href="/OnJava8/assets/js/61.8934c875.js"><link rel="prefetch" href="/OnJava8/assets/js/62.121387c8.js"><link rel="prefetch" href="/OnJava8/assets/js/63.6a16727c.js"><link rel="prefetch" href="/OnJava8/assets/js/64.86b8c49d.js"><link rel="prefetch" href="/OnJava8/assets/js/65.99ec7c7e.js"><link rel="prefetch" href="/OnJava8/assets/js/66.4795617e.js"><link rel="prefetch" href="/OnJava8/assets/js/67.ecec3f29.js"><link rel="prefetch" href="/OnJava8/assets/js/68.e44b104e.js"><link rel="prefetch" href="/OnJava8/assets/js/69.617dfdda.js"><link rel="prefetch" href="/OnJava8/assets/js/7.7318851b.js"><link rel="prefetch" href="/OnJava8/assets/js/70.40676679.js"><link rel="prefetch" href="/OnJava8/assets/js/71.d8d538d0.js"><link rel="prefetch" href="/OnJava8/assets/js/72.f95b8e33.js"><link rel="prefetch" href="/OnJava8/assets/js/73.f6532a41.js"><link rel="prefetch" href="/OnJava8/assets/js/74.e8f97344.js"><link rel="prefetch" href="/OnJava8/assets/js/75.085fa345.js"><link rel="prefetch" href="/OnJava8/assets/js/76.420549b7.js"><link rel="prefetch" href="/OnJava8/assets/js/77.1f037b07.js"><link rel="prefetch" href="/OnJava8/assets/js/78.98f9cb60.js"><link rel="prefetch" href="/OnJava8/assets/js/79.cc8dfd96.js"><link rel="prefetch" href="/OnJava8/assets/js/8.d6fb4b4c.js"><link rel="prefetch" href="/OnJava8/assets/js/80.8b400208.js"><link rel="prefetch" href="/OnJava8/assets/js/81.a07925a3.js"><link rel="prefetch" href="/OnJava8/assets/js/82.bbc9c3a5.js"><link rel="prefetch" href="/OnJava8/assets/js/83.0bd8088e.js"><link rel="prefetch" href="/OnJava8/assets/js/84.5fea0fdf.js"><link rel="prefetch" href="/OnJava8/assets/js/85.0fd78530.js"><link rel="prefetch" href="/OnJava8/assets/js/87.7b60b9e3.js"><link rel="prefetch" href="/OnJava8/assets/js/88.96e41f5e.js"><link rel="prefetch" href="/OnJava8/assets/js/89.2e526626.js"><link rel="prefetch" href="/OnJava8/assets/js/9.bee0ed10.js"><link rel="prefetch" href="/OnJava8/assets/js/90.f0a371b9.js"><link rel="prefetch" href="/OnJava8/assets/js/91.7a7b5b85.js"><link rel="prefetch" href="/OnJava8/assets/js/92.189a9131.js"><link rel="prefetch" href="/OnJava8/assets/js/93.fd76990e.js"><link rel="prefetch" href="/OnJava8/assets/js/94.b5e49e22.js"><link rel="prefetch" href="/OnJava8/assets/js/95.cf479383.js"><link rel="prefetch" href="/OnJava8/assets/js/96.989a6d03.js"><link rel="prefetch" href="/OnJava8/assets/js/97.aa9f7dd6.js"><link rel="prefetch" href="/OnJava8/assets/js/98.4d5f2cf9.js"><link rel="prefetch" href="/OnJava8/assets/js/99.a38a4414.js">
    <link rel="stylesheet" href="/OnJava8/assets/css/0.styles.ad933ae4.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/OnJava8/" class="home-link router-link-active"><img src="/OnJava8/OnJava8/images/logo.png" alt="一席之地" class="logo"> <span class="site-name can-hide">一席之地</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/OnJava8/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><a href="/OnJava8/book/" class="link-title">书籍</a> <span class="title" style="display:none;">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>精品</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/OnJava8/pages/5a259f/" class="nav-link">Java编程思想</a></li><li class="dropdown-subitem"><a href="/OnJava8/pages/521774/" class="nav-link">Effective Java</a></li></ul></li></ul></div></div> <a href="https://github.com/chenjianyao/OnJava8" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/OnJava8/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><a href="/OnJava8/book/" class="link-title">书籍</a> <span class="title" style="display:none;">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>精品</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/OnJava8/pages/5a259f/" class="nav-link">Java编程思想</a></li><li class="dropdown-subitem"><a href="/OnJava8/pages/521774/" class="nav-link">Effective Java</a></li></ul></li></ul></div></div> <a href="https://github.com/chenjianyao/OnJava8" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/OnJava8/book/" class="sidebar-link">书籍</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>读书笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java编程思想</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Effective Java</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OnJava8/pages/521774/" class="sidebar-link">考虑使用静态工厂方法替代构造方法</a></li><li><a href="/OnJava8/pages/ad6cbc/" class="sidebar-link">当构造方法参数过多时使用builder模式</a></li><li><a href="/OnJava8/pages/8cb856/" class="sidebar-link">使用私有构造方法或枚类实现Singleton属性</a></li><li><a href="/OnJava8/pages/f88ecb/" class="sidebar-link">使用私有构造方法执行非实例化</a></li><li><a href="/OnJava8/pages/41c514/" class="sidebar-link">依赖注入优于硬连接资源(hardwiring resources)</a></li><li><a href="/OnJava8/pages/709e11/" class="sidebar-link">避免创建不必要的对象</a></li><li><a href="/OnJava8/pages/959c54/" class="sidebar-link">消除过期的对象引用</a></li><li><a href="/OnJava8/pages/e765de/" class="sidebar-link">避免使用Finalizer和Cleaner机制</a></li><li><a href="/OnJava8/pages/a66224/" class="sidebar-link">使用try-with-resources语句替代try-finally语句</a></li><li><a href="/OnJava8/pages/65b752/" class="sidebar-link">重写equals方法时遵守通用约定</a></li><li><a href="/OnJava8/pages/e29538/" class="sidebar-link">重写equals方法时同时也要重写hashcode方法</a></li><li><a href="/OnJava8/pages/df7ccb/" class="sidebar-link">始终重写 toString 方法</a></li><li><a href="/OnJava8/pages/09e324/" class="sidebar-link">谨慎地重写 clone 方法</a></li><li><a href="/OnJava8/pages/f26063/" class="sidebar-link">考虑实现Comparable接口</a></li><li><a href="/OnJava8/pages/40b952/" class="sidebar-link">使类和成员的可访问性最小化</a></li><li><a href="/OnJava8/pages/96bbbb/" class="sidebar-link">在公共类中使用访问方法而不是公共属性</a></li><li><a href="/OnJava8/pages/130307/" class="sidebar-link">最小化可变性</a></li><li><a href="/OnJava8/pages/7d2ea7/" class="sidebar-link">组合优于继承</a></li><li><a href="/OnJava8/pages/7ff6fe/" class="sidebar-link">要么设计继承并提供文档说明，要么禁用继承</a></li><li><a href="/OnJava8/pages/9ffa0b/" class="sidebar-link">接口优于抽象类</a></li><li><a href="/OnJava8/pages/901098/" class="sidebar-link">为后代设计接口</a></li><li><a href="/OnJava8/pages/c15bfc/" class="sidebar-link">接口仅用来定义类型</a></li><li><a href="/OnJava8/pages/9afa3b/" class="sidebar-link">类层次结构优于标签类</a></li><li><a href="/OnJava8/pages/acaab0/" class="sidebar-link">支持使用静态成员类而不是非静态类</a></li><li><a href="/OnJava8/pages/154515/" class="sidebar-link">将源文件限制为单个顶级类</a></li><li><a href="/OnJava8/pages/f404c6/" class="sidebar-link">不要使用原始类型</a></li><li><a href="/OnJava8/pages/64baa8/" class="sidebar-link">消除非检查警告</a></li><li><a href="/OnJava8/pages/c5f5b1/" class="sidebar-link">列表优于数组</a></li><li><a href="/OnJava8/pages/976cf0/" class="sidebar-link">优先考虑泛型</a></li><li><a href="/OnJava8/pages/1d968c/" class="sidebar-link">优先使用泛型方法</a></li><li><a href="/OnJava8/pages/aae9a5/" class="sidebar-link">使用限定通配符来增加API的灵活性</a></li><li><a href="/OnJava8/pages/906989/" class="sidebar-link">合理地结合泛型和可变参数</a></li><li><a href="/OnJava8/pages/299d7f/" class="sidebar-link">优先考虑类型安全的异构容器</a></li><li><a href="/OnJava8/pages/7e2d05/" aria-current="page" class="active sidebar-link">使用枚举类型替代整型常量</a></li><li><a href="/OnJava8/pages/5d9e49/" class="sidebar-link">使用实例属性替代序数</a></li><li><a href="/OnJava8/pages/7043ef/" class="sidebar-link">使用EnumSet替代位属性</a></li><li><a href="/OnJava8/pages/b728a9/" class="sidebar-link">使用EnumMap替代序数索引</a></li><li><a href="/OnJava8/pages/a897ec/" class="sidebar-link">使用接口模拟可扩展的枚举</a></li><li><a href="/OnJava8/pages/33843a/" class="sidebar-link">注解优于命名模式</a></li><li><a href="/OnJava8/pages/4d33e9/" class="sidebar-link">始终使用Override注解</a></li><li><a href="/OnJava8/pages/4680ce/" class="sidebar-link">使用标记接口定义类型</a></li><li><a href="/OnJava8/pages/7f3456/" class="sidebar-link">lambda表达式优于匿名类</a></li><li><a href="/OnJava8/pages/d97181/" class="sidebar-link">方法引用优于lambda表达式</a></li><li><a href="/OnJava8/pages/32e0d0/" class="sidebar-link">优先使用标准的函数式接口</a></li><li><a href="/OnJava8/pages/0bdbb9/" class="sidebar-link">明智审慎地使用Stream</a></li><li><a href="/OnJava8/pages/b8b7d2/" class="sidebar-link">优先考虑流中无副作用的函数</a></li><li><a href="/OnJava8/pages/163199/" class="sidebar-link">谨慎使用流并行</a></li><li><a href="/OnJava8/pages/deb655/" class="sidebar-link">检查参数有效性</a></li><li><a href="/OnJava8/pages/c28c5f/" class="sidebar-link">必要时进行防御性拷贝</a></li><li><a href="/OnJava8/pages/e23512/" class="sidebar-link">仔细设计方法签名</a></li><li><a href="/OnJava8/pages/c6257a/" class="sidebar-link">明智审慎地使用重载</a></li><li><a href="/OnJava8/pages/4dd512/" class="sidebar-link">明智审慎地使用可变参数</a></li><li><a href="/OnJava8/pages/9a714a/" class="sidebar-link">返回空的数组或集合，不要返回 null</a></li><li><a href="/OnJava8/pages/5e80b5/" class="sidebar-link">明智审慎地返回 Optional</a></li><li><a href="/OnJava8/pages/74c106/" class="sidebar-link">为所有已公开的 API 元素编写文档注释</a></li><li><a href="/OnJava8/pages/912e8c/" class="sidebar-link">最小化局部变量的作用域</a></li><li><a href="/OnJava8/pages/35c894/" class="sidebar-link">for-each 循环优于传统 for 循环</a></li><li><a href="/OnJava8/pages/bf74de/" class="sidebar-link">了解并使用库</a></li><li><a href="/OnJava8/pages/a99d35/" class="sidebar-link">若需要精确答案就应避免使用 float 和 double 类型</a></li><li><a href="/OnJava8/pages/81cf40/" class="sidebar-link">基本数据类型优于包装类</a></li><li><a href="/OnJava8/pages/c7bbb3/" class="sidebar-link">当使用其他类型更合适时应避免使用字符串</a></li><li><a href="/OnJava8/pages/74ec04/" class="sidebar-link">当心字符串连接引起的性能问题</a></li><li><a href="/OnJava8/pages/aefc74/" class="sidebar-link">通过接口引用对象</a></li><li><a href="/OnJava8/pages/b4b8b5/" class="sidebar-link">接口优于反射</a></li><li><a href="/OnJava8/pages/65ee7f/" class="sidebar-link">明智审慎地本地方法</a></li><li><a href="/OnJava8/pages/18c504/" class="sidebar-link">明智审慎地进行优化</a></li><li><a href="/OnJava8/pages/f744e1/" class="sidebar-link">遵守被广泛认可的命名约定</a></li><li><a href="/OnJava8/pages/35b71f/" class="sidebar-link">只针对异常的情况下才使用异常</a></li><li><a href="/OnJava8/pages/6af810/" class="sidebar-link">对可恢复的情况使用受检异常，对编程错误使用运行时异常</a></li><li><a href="/OnJava8/pages/2ad459/" class="sidebar-link">避免不必要的使用受检异常</a></li><li><a href="/OnJava8/pages/37b2f9/" class="sidebar-link">优先使用标准的异常</a></li><li><a href="/OnJava8/pages/736442/" class="sidebar-link">抛出与抽象对应的异常</a></li><li><a href="/OnJava8/pages/0f4860/" class="sidebar-link">每个方法抛出的异常都需要创建文档</a></li><li><a href="/OnJava8/pages/643f4f/" class="sidebar-link">在细节消息中包含失败一捕获信息</a></li><li><a href="/OnJava8/pages/f35a3a/" class="sidebar-link">保持失败原子性</a></li><li><a href="/OnJava8/pages/42e94b/" class="sidebar-link">不要忽略异常</a></li><li><a href="/OnJava8/pages/2e54d9/" class="sidebar-link">同步访问共享的可变数据</a></li><li><a href="/OnJava8/pages/849f24/" class="sidebar-link">避免过度同步</a></li><li><a href="/OnJava8/pages/a8535e/" class="sidebar-link">executor 、task 和 stream 优先于线程</a></li><li><a href="/OnJava8/pages/27848c/" class="sidebar-link">并发工具优于 wait 和 notify</a></li><li><a href="/OnJava8/pages/379820/" class="sidebar-link">文档应包含线程安全属性</a></li><li><a href="/OnJava8/pages/685a39/" class="sidebar-link">明智审慎的使用延迟初始化</a></li><li><a href="/OnJava8/pages/df0a31/" class="sidebar-link">不要依赖线程调度器</a></li><li><a href="/OnJava8/pages/48ff5f/" class="sidebar-link">优先选择 Java 序列化的替代方案</a></li><li><a href="/OnJava8/pages/d1679f/" class="sidebar-link">非常谨慎地实现 Serializable</a></li><li><a href="/OnJava8/pages/de0707/" class="sidebar-link">考虑使用自定义的序列化形式</a></li><li><a href="/OnJava8/pages/2bfa05/" class="sidebar-link">保护性的编写 readObject 方法</a></li><li><a href="/OnJava8/pages/4fcb2c/" class="sidebar-link">对于实例控制，枚举类型优于 readResolve</a></li><li><a href="/OnJava8/pages/70e740/" class="sidebar-link">考虑用序列化代理代替序列化实例</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/OnJava8/" title="首页" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><a href="/OnJava8/categories/?category=%E4%B9%A6%E7%B1%8D" title="分类" data-v-0c557b5e>书籍</a></li><li data-v-0c557b5e><a href="/OnJava8/categories/?category=Effective%20Java" title="分类" data-v-0c557b5e>Effective Java</a></li></ul> <div class="info" data-v-0c557b5e><div title="作者" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="https://github.com/chenjianyao" target="_blank" title="作者" class="beLink" data-v-0c557b5e>chenjianyao</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2022-02-11</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><!----> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">使用枚举类型替代整型常量<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p>Java 支持两种引用类型的特殊用途的系列：一种称为枚举类型的类和一种称为注解类型的接口。 本章讨论使用这些类型系列的最佳实践。</p> <h1 id="_34-使用枚举类型替代整型常量"><a href="#_34-使用枚举类型替代整型常量" class="header-anchor">#</a> 34. 使用枚举类型替代整型常量</h1> <p>枚举是其合法值由一组固定的常量组成的一种类型，例如一年中的季节，太阳系中的行星或一副扑克牌中的花色。 在将枚举类型添加到该语言之前，表示枚举类型的常见模式是声明一组名为 <code>int</code> 的常量，每个类型的成员都有一个常量：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// The int enum pattern - severely deficient!</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> APPLE_FUJI         <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> APPLE_PIPPIN       <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> APPLE_GRANNY_SMITH <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> ORANGE_NAVEL  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> ORANGE_TEMPLE <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> ORANGE_BLOOD  <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>这种被称为 <code>int</code> 枚举模式的技术有许多缺点。 它没有提供类型安全的方式，也没有提供任何表达力。 如果你将一个 <code>Apple</code> 传递给一个需要 <code>Orange</code> 的方法，那么编译器不会出现警告，还会用 == 运算符比较 <code>Apple</code> 与 <code>Orange</code>，或者更糟糕的是：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Tasty citrus flavored applesauce!</span>
<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>APPLE_FUJI <span class="token operator">-</span> ORANGE_TEMPLE<span class="token punctuation">)</span> <span class="token operator">/</span> APPLE_PIPPIN<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>请注意，每个 <code>Apple</code> 常量的名称前缀为 <code>APPLE_</code>，每个 <code>Orange</code> 常量的名称前缀为 <code>ORANGE_</code>。 这是因为 Java 不为 <code>int</code> 枚举组提供名称空间。 当两个 <code>int</code>a 枚举组具有相同的命名常量时，前缀可以防止名称冲突，例如在 <code>ELEMENT_MERCURY</code> 和 <code>PLANET_MERCURY</code> 之间。</p> <p>使用 <code>int</code> 枚举的程序很脆弱。 因为 <code>int</code> 枚举是编译时常量[JLS，4.12.4]，所以它们的 <code>int</code> 值被编译到使用它们的客户端中[JLS，13.1]。 如果与 <code>int</code> 枚举关联的值发生更改，则必须重新编译其客户端。 如果没有，客户仍然会运行，但他们的行为将是不正确的。</p> <p>没有简单的方法将 <code>int</code> 枚举常量转换为可打印的字符串。 如果你打印这样一个常量或者从调试器中显示出来，你看到的只是一个数字，这不是很有用。 没有可靠的方法来迭代组中的所有 <code>int</code> 枚举常量，甚至无法获得 <code>int</code> 枚举组的大小。</p> <p>你可能会遇到这种模式的变体，其中使用了字符串常量来代替 <code>int</code> 常量。 这种称为字符串枚举模式的变体更不理想。 尽管它为常量提供了可打印的字符串，但它可以导致初级用户将字符串常量硬编码为客户端代码，而不是使用属性名称。 如果这种硬编码的字符串常量包含书写错误，它将在编译时逃脱检测并导致运行时出现错误。 此外，它可能会导致性能问题，因为它依赖于字符串比较。</p> <p>幸运的是，Java 提供了一种避免 <code>int</code> 和 <code>String</code> 枚举模式的所有缺点的替代方法，并提供了许多额外的好处。 它是枚举类型[JLS，8.9]。 以下是它最简单的形式：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Apple</span>  <span class="token punctuation">{</span> FUJI<span class="token punctuation">,</span> PIPPIN<span class="token punctuation">,</span> GRANNY_SMITH <span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Orange</span> <span class="token punctuation">{</span> NAVEL<span class="token punctuation">,</span> TEMPLE<span class="token punctuation">,</span> BLOOD <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>从表面上看，这些枚举类型可能看起来与其他语言类似，比如 C，C++和 C＃，但事实并非如此。 Java 的枚举类型是完整的类，比其他语言中的其他语言更强大，其枚举本质本上是 <code>int</code> 值。</p> <p>Java 枚举类型背后的基本思想很简单：它们是通过公共静态 <code>final</code> 属性为每个枚举常量导出一个实例的类。 由于没有可访问的构造方法，枚举类型实际上是 <code>final</code> 的。 由于客户既不能创建枚举类型的实例也不能继承它，除了声明的枚举常量外，不能有任何实例。 换句话说，枚举类型是实例控制的（第 6 页）。 它们是单例（详见第 3 条）的泛型化，基本上是单元素的枚举。</p> <p>枚举提供了编译时类型的安全性。 如果声明一个参数为 <code>Apple</code> 类型，则可以保证传递给该参数的任何非空对象引用是三个有效 <code>Apple</code> 值中的一个。 尝试传递错误类型的值将导致编译时错误，因为会尝试将一个枚举类型的表达式分配给另一个类型的变量，或者使用 <code>==</code> 运算符来比较不同枚举类型的值。</p> <p>具有相同名称常量的枚举类型可以和平共存，因为每种类型都有其自己的名称空间。 可以在枚举类型中添加或重新排序常量，而无需重新编译其客户端，因为导出常量的属性在枚举类型与其客户端之间提供了一层隔离：常量值不会编译到客户端，因为它们位于 <code>int</code> 枚举模式中。 最后，可以通过调用其 <code>toString</code> 方法将枚举转换为可打印的字符串。</p> <p>除了纠正 <code>int</code> 枚举的缺陷之外，枚举类型还允许添加任意方法和属性并实现任意接口。 它们提供了所有 <code>Object</code> 方法的高质量实现（第 3 章），它们实现了 <code>Comparable</code>（详见第 14 条）和 <code>Serializable</code>（第 12 章），并针对枚举类型的可任意改变性设计了序列化方式。</p> <p>那么，为什么你要添加方法或属性到一个枚举类型？ 对于初学者，可能想要将数据与其常量关联起来。 例如，我们的 <code>Apple</code> 和 <code>Orange</code> 类型可能会从返回水果颜色的方法或返回水果图像的方法中受益。 还可以使用任何看起来合适的方法来增强枚举类型。 枚举类型可以作为枚举常量的简单集合，并随着时间的推移而演变为全功能抽象。</p> <p>对于丰富的枚举类型的一个很好的例子，考虑我们太阳系的八颗行星。 每个行星都有质量和半径，从这两个属性可以计算出它的表面重力。 从而在给定物体的质量下，计算出一个物体在行星表面上的重量。 下面是这个枚举类型。 每个枚举常量之后的括号中的数字是传递给其构造方法的参数。 在这种情况下，它们是地球的质量和半径：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Enum type with data and behavior</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Planet</span> <span class="token punctuation">{</span>
    <span class="token function">MERCURY</span><span class="token punctuation">(</span><span class="token number">3.302e+23</span><span class="token punctuation">,</span> <span class="token number">2.439e6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    VENUS  <span class="token punctuation">(</span><span class="token number">4.869e+24</span><span class="token punctuation">,</span> <span class="token number">6.052e6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    EARTH  <span class="token punctuation">(</span><span class="token number">5.975e+24</span><span class="token punctuation">,</span> <span class="token number">6.378e6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    MARS   <span class="token punctuation">(</span><span class="token number">6.419e+23</span><span class="token punctuation">,</span> <span class="token number">3.393e6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">JUPITER</span><span class="token punctuation">(</span><span class="token number">1.899e+27</span><span class="token punctuation">,</span> <span class="token number">7.149e7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    SATURN <span class="token punctuation">(</span><span class="token number">5.685e+26</span><span class="token punctuation">,</span> <span class="token number">6.027e7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    URANUS <span class="token punctuation">(</span><span class="token number">8.683e+25</span><span class="token punctuation">,</span> <span class="token number">2.556e7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">NEPTUNE</span><span class="token punctuation">(</span><span class="token number">1.024e+26</span><span class="token punctuation">,</span> <span class="token number">2.477e7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">double</span> mass<span class="token punctuation">;</span>           <span class="token comment">// In kilograms</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">double</span> radius<span class="token punctuation">;</span>         <span class="token comment">// In meters</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">double</span> surfaceGravity<span class="token punctuation">;</span> <span class="token comment">// In m / s^2</span>
    <span class="token comment">// Universal gravitational constant in m^3 / kg s^2</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">double</span> <span class="token class-name">G</span> <span class="token operator">=</span> <span class="token number">6.67300E-11</span><span class="token punctuation">;</span>

    <span class="token comment">// Constructor</span>
    <span class="token class-name">Planet</span><span class="token punctuation">(</span><span class="token keyword">double</span> mass<span class="token punctuation">,</span> <span class="token keyword">double</span> radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mass <span class="token operator">=</span> mass<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>radius <span class="token operator">=</span> radius<span class="token punctuation">;</span>
        surfaceGravity <span class="token operator">=</span> <span class="token class-name">G</span> <span class="token operator">*</span> mass <span class="token operator">/</span> <span class="token punctuation">(</span>radius <span class="token operator">*</span> radius<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">mass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token punctuation">{</span> <span class="token keyword">return</span> mass<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">radius</span><span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token punctuation">{</span> <span class="token keyword">return</span> radius<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">surfaceGravity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> surfaceGravity<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">surfaceWeight</span><span class="token punctuation">(</span><span class="token keyword">double</span> mass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> mass <span class="token operator">*</span> surfaceGravity<span class="token punctuation">;</span>  <span class="token comment">// F = ma</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>编写一个丰富的枚举类型比如 <code>Planet</code> 很容易。  <strong>要将数据与枚举常量相关联，请声明实例属性并编写一个构造方法，构造方法带有数据并将数据保存在属性中。</strong>  枚举本质上是不变的，所以所有的属性都应该是 <code>final</code> 的（详见第 17 条）。 属性可以是公开的，但最好将它们设置为私有并提供公共访问方法（详见第 16 条）。 在 <code>Planet</code> 的情况下，构造方法还计算和存储表面重力，但这只是一种优化。 每当重力被 <code>SurfaceWeight</code> 方法使用时，它可以从质量和半径重新计算出来，该方法返回它在由常数表示的行星上的重量。</p> <p>虽然 <code>Planet</code> 枚举很简单，但它的功能非常强大。 这是一个简短的程序，它将一个物体在地球上的重量（任何单位），打印一个漂亮的表格，显示该物体在所有八个行星上的重量（以相同单位）：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeightTable</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">double</span> earthWeight <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">double</span> mass <span class="token operator">=</span> earthWeight <span class="token operator">/</span> <span class="token class-name">Planet</span><span class="token punctuation">.</span>EARTH<span class="token punctuation">.</span><span class="token function">surfaceGravity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Planet</span> p <span class="token operator">:</span> <span class="token class-name">Planet</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Weight on %s is %f%n&quot;</span><span class="token punctuation">,</span>
                            p<span class="token punctuation">,</span> p<span class="token punctuation">.</span><span class="token function">surfaceWeight</span><span class="token punctuation">(</span>mass<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>请注意，<code>Planet</code> 和所有枚举一样，都有一个静态 <code>values</code> 方法，该方法以声明的顺序返回其值的数组。 另请注意，<code>toString</code> 方法返回每个枚举值的声明名称，使 <code>println</code> 和 <code>printf</code> 可以轻松打印。 如果你对此字符串表示形式不满意，可以通过重写 <code>toString</code> 方法来更改它。 这是使用命令行参数 185 运行 <code>WeightTable</code> 程序（不重写 <code>toString</code>）的结果：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Weight</span> on MERCURY is <span class="token number">69.912739</span>
<span class="token class-name">Weight</span> on VENUS is <span class="token number">167.434436</span>
<span class="token class-name">Weight</span> on EARTH is <span class="token number">185.000000</span>
<span class="token class-name">Weight</span> on MARS is <span class="token number">70.226739</span>
<span class="token class-name">Weight</span> on JUPITER is <span class="token number">467.990696</span>
<span class="token class-name">Weight</span> on SATURN is <span class="token number">197.120111</span>
<span class="token class-name">Weight</span> on URANUS is <span class="token number">167.398264</span>
<span class="token class-name">Weight</span> on NEPTUNE is <span class="token number">210.208751</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>直到 2006 年，在 Java 中加入枚举两年之后，冥王星不再是一颗行星。 这引发了一个问题：「当你从枚举类型中移除一个元素时会发生什么？」答案是，任何不引用移除元素的客户端程序都将继续正常工作。 所以，举例来说，我们的 <code>WeightTable</code> 程序将会打印一个少一行的表格。 那么客户端程序引用删除的元素（在本例中是<code>Planet.Pluto</code>）会如何？ 如果重新编译客户端程序，编译将会失败并在引用删除的星球的行处提供有用的错误消息; 如果无法重新编译客户端，它将在运行时从此行中引发有用的异常。 这是你所希望的最好的行为，远远好于你用 <code>int</code> 枚举模式得到的结果。</p> <p>一些与枚举常量相关的行为只需要在定义枚举的类或包中使用。 这些行为最好以私有或包级私有方式实现。 然后每个常量携带一个隐藏的行为集合，这些行为允许包含枚举的类或包在呈现常量时作出适当的反应。 与其他类一样，除非你有一个令人信服的理由将枚举方法暴露给它的客户端，否则将其声明为私有的，如果需要的话将其声明为包级私有（详见第 15 条）。</p> <p>如果一个枚举是广泛使用的，它应该是一个顶级类; 如果它的使用与特定的顶级类绑定，它应该是该顶级类的成员类（详见第 24 条）。 例如，<code>java.math.RoundingMode</code> 枚举表示小数部分的舍入模式。 <code>BigDecimal</code> 类使用了这些舍入模式，但它们提供了一种有用的抽象，它并不与 <code>BigDecimal</code> 有根本的联系。 通过将 <code>RoundingMode</code> 设置为顶层枚举，类库设计人员鼓励任何需要舍入模式的程序员重用此枚举，从而提高跨 <code>API</code> 的一致性。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Enum type that switches on its own value - questionable</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Operation</span> <span class="token punctuation">{</span>
    PLUS<span class="token punctuation">,</span> MINUS<span class="token punctuation">,</span> TIMES<span class="token punctuation">,</span> DIVIDE<span class="token punctuation">;</span>

    <span class="token comment">// Do the arithmetic operation represented by this constant</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> PLUS<span class="token operator">:</span>   <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
            <span class="token keyword">case</span> MINUS<span class="token operator">:</span>  <span class="token keyword">return</span> x <span class="token operator">-</span> y<span class="token punctuation">;</span>
            <span class="token keyword">case</span> TIMES<span class="token operator">:</span>  <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
            <span class="token keyword">case</span> DIVIDE<span class="token operator">:</span> <span class="token keyword">return</span> x <span class="token operator">/</span> y<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AssertionError</span><span class="token punctuation">(</span><span class="token string">&quot;Unknown op: &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>此代码有效，但不是很漂亮。 如果没有 <code>throw</code> 语句，就不能编译，因为该方法的结束在技术上是可达到的，尽管它永远不会被达到[JLS，14.21]。 更糟的是，代码很脆弱。 如果添加新的枚举常量，但忘记向 <code>switch</code> 语句添加相应的条件，枚举仍然会编译，但在尝试应用新操作时，它将在运行时失败。</p> <p>幸运的是，有一种更好的方法可以将不同的行为与每个枚举常量关联起来：在枚举类型中声明一个抽象的 apply 方法，并用常量特定的类主体中的每个常量的具体方法重写它。 这种方法被称为特定于常量（constant-specific）的方法实现：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Enum type with constant-specific method implementations</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Operation</span> <span class="token punctuation">{</span>
  PLUS  <span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  MINUS <span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> x <span class="token operator">-</span> y<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  TIMES <span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  DIVIDE<span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> x <span class="token operator">/</span> y<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>如果向第二个版本的操作添加新的常量，则不太可能会忘记提供 <code>apply</code> 方法，因为该方法紧跟在每个常量声明之后。 万一忘记了，编译器会提醒你，因为枚举类型中的抽象方法必须被所有常量中的具体方法重写。</p> <p>特定于常量的方法实现可以与特定于常量的数据结合使用。 例如，以下是 <code>Operation</code> 的一个版本，它重写 <code>toString</code> 方法以返回通常与该操作关联的符号：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Enum type with constant-specific class bodies and data</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Operation</span> <span class="token punctuation">{</span>
    <span class="token function">PLUS</span><span class="token punctuation">(</span><span class="token string">&quot;+&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">MINUS</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">-</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">TIMES</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">DIVIDE</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">/</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> symbol<span class="token punctuation">;</span>

    <span class="token class-name">Operation</span><span class="token punctuation">(</span><span class="token class-name">String</span> symbol<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>symbol <span class="token operator">=</span> symbol<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> symbol<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">double</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>显示的 <code>toString</code> 实现可以很容易地打印算术表达式，正如这个小程序所展示的那样：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> y <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Operation</span> op <span class="token operator">:</span> <span class="token class-name">Operation</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%f %s %f = %f%n&quot;</span><span class="token punctuation">,</span>
                          x<span class="token punctuation">,</span> op<span class="token punctuation">,</span> y<span class="token punctuation">,</span> op<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>以 2 和 4 作为命令行参数运行此程序会生成以下输出：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token number">2.000000</span> <span class="token operator">+</span> <span class="token number">4.000000</span> <span class="token operator">=</span> <span class="token number">6.000000</span>
<span class="token number">2.000000</span> <span class="token operator">-</span> <span class="token number">4.000000</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2.000000</span>
<span class="token number">2.000000</span> <span class="token operator">*</span> <span class="token number">4.000000</span> <span class="token operator">=</span> <span class="token number">8.000000</span>
<span class="token number">2.000000</span> <span class="token operator">/</span> <span class="token number">4.000000</span> <span class="token operator">=</span> <span class="token number">0.500000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>枚举类型具有自动生成的 <code>valueOf(String)</code> 方法，该方法将常量名称转换为常量本身。 如果在枚举类型中重写 <code>toString</code> 方法，请考虑编写 <code>fromString</code> 方法将自定义字符串表示法转换回相应的枚举类型。 下面的代码（类型名称被适当地改变）将对任何枚举都有效，只要每个常量具有唯一的字符串表示形式：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Implementing a fromString method on an enum type</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Operation</span><span class="token punctuation">&gt;</span></span> stringToEnum <span class="token operator">=</span>
        <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>
            <span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token operator">::</span><span class="token function">toString</span><span class="token punctuation">,</span> e <span class="token operator">-&gt;</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns Operation for string, if any</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Operation</span><span class="token punctuation">&gt;</span></span> <span class="token function">fromString</span><span class="token punctuation">(</span><span class="token class-name">String</span> symbol<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>stringToEnum<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>请注意，<code>Operation</code> 枚举常量被放在 <code>stringToEnum</code> 的 <code>map</code> 中，它来自于创建枚举常量后运行的静态属性初始化。前面的代码在 <code>values()</code> 方法返回的数组上使用流（第 7 章）；在 Java 8 之前，我们创建一个空的 <code>hashMap</code> 并遍历值数组，将字符串到枚举映射插入到 <code>map</code> 中，如果愿意，仍然可以这样做。但请注意，尝试让每个常量都将自己放入来自其构造方法的 <code>map</code> 中不起作用。这会导致编译错误，这是好事，因为如果它是合法的，它会在运行时导致 <code>NullPointerException</code>。除了编译时常量属性（详见第 34 条）之外，枚举构造方法不允许访问枚举的静态属性。此限制是必需的，因为静态属性在枚举构造方法运行时尚未初始化。这种限制的一个特例是枚举常量不能从构造方法中相互访问。</p> <p>另请注意，<code>fromString</code> 方法返回一个 <code>Optional&lt;String&gt;</code>。 这允许该方法指示传入的字符串不代表有效的操作，并且强制客户端面对这种可能性（详见第 55 条）。</p> <p>特定于常量的方法实现的一个缺点是它们使得难以在枚举常量之间共享代码。 例如，考虑一个代表工资包中的工作天数的枚举。 该枚举有一个方法，根据工人的基本工资（每小时）和当天工作的分钟数计算当天工人的工资。 在五个工作日内，任何超过正常工作时间的工作都会产生加班费; 在两个周末的日子里，所有工作都会产生加班费。 使用 <code>switch</code> 语句，通过将多个 <code>case</code> 标签应用于两个代码片段中的每一个，可以轻松完成此计算：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Enum that switches on its value to share code - questionable</span>
<span class="token keyword">enum</span> <span class="token class-name">PayrollDay</span> <span class="token punctuation">{</span>
    MONDAY<span class="token punctuation">,</span> TUESDAY<span class="token punctuation">,</span> WEDNESDAY<span class="token punctuation">,</span> THURSDAY<span class="token punctuation">,</span> FRIDAY<span class="token punctuation">,</span>
    SATURDAY<span class="token punctuation">,</span> SUNDAY<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MINS_PER_SHIFT <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token keyword">int</span> minutesWorked<span class="token punctuation">,</span> <span class="token keyword">int</span> payRate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> basePay <span class="token operator">=</span> minutesWorked <span class="token operator">*</span> payRate<span class="token punctuation">;</span>

        <span class="token keyword">int</span> overtimePay<span class="token punctuation">;</span>
        <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">case</span> SATURDAY<span class="token operator">:</span> <span class="token keyword">case</span> SUNDAY<span class="token operator">:</span> <span class="token comment">// Weekend</span>
            overtimePay <span class="token operator">=</span> basePay <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token keyword">default</span><span class="token operator">:</span> <span class="token comment">// Weekday</span>
            overtimePay <span class="token operator">=</span> minutesWorked <span class="token operator">&lt;=</span> MINS_PER_SHIFT <span class="token operator">?</span>
              <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>minutesWorked <span class="token operator">-</span> MINS_PER_SHIFT<span class="token punctuation">)</span> <span class="token operator">*</span> payRate <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> basePay <span class="token operator">+</span> overtimePay<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>这段代码无可否认是简洁的，但从维护的角度来看是危险的。 假设你给枚举添加了一个元素，可能是一个特殊的值来表示一个假期，但忘记在 <code>switch</code> 语句中添加一个相应的 <code>case</code> 条件。 该程序仍然会编译，但付费方法会默默地为工作日支付相同数量的休假日，与普通工作日相同。</p> <p>要使用特定于常量的方法实现安全地执行工资计算，必须为每个常量重复加班工资计算，或将计算移至两个辅助方法，一个用于工作日，另一个用于周末，并调用适当的辅助方法来自每个常量。 这两种方法都会产生相当数量的样板代码，大大降低了可读性并增加了出错机会。</p> <p>通过使用执行加班计算的具体方法替换 <code>PayrollDay</code> 上的抽象 <code>overtimePay</code> 方法，可以减少样板。 那么只有周末的日子必须重写该方法。 但是，这与 <code>switch</code> 语句具有相同的缺点：如果在不重写 <code>overtimePay</code> 方法的情况下添加另一天，则会默默继承周日计算方式。</p> <p>你真正想要的是每次添加枚举常量时被迫选择加班费策略。 幸运的是，有一个很好的方法来实现这一点。 这个想法是将加班费计算移入私有嵌套枚举中，并将此策略枚举的实例传递给 <code>PayrollDay</code> 枚举的构造方法。 然后，<code>PayrollDay</code> 枚举将加班工资计算委托给策略枚举，从而无需在 <code>PayrollDay</code> 中实现 <code>switch</code> 语句或特定于常量的方法实现。 虽然这种模式不如 <code>switch</code> 语句简洁，但它更安全，更灵活：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// The strategy enum pattern</span>
<span class="token keyword">enum</span> <span class="token class-name">PayrollDay</span> <span class="token punctuation">{</span>
    MONDAY<span class="token punctuation">,</span> TUESDAY<span class="token punctuation">,</span> WEDNESDAY<span class="token punctuation">,</span> THURSDAY<span class="token punctuation">,</span> FRIDAY<span class="token punctuation">,</span>
    <span class="token function">SATURDAY</span><span class="token punctuation">(</span><span class="token class-name">PayType</span><span class="token punctuation">.</span>WEEKEND<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SUNDAY</span><span class="token punctuation">(</span><span class="token class-name">PayType</span><span class="token punctuation">.</span>WEEKEND<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">PayType</span> payType<span class="token punctuation">;</span>

    <span class="token class-name">PayrollDay</span><span class="token punctuation">(</span><span class="token class-name">PayType</span> payType<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>payType <span class="token operator">=</span> payType<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token class-name">PayrollDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token class-name">PayType</span><span class="token punctuation">.</span>WEEKDAY<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token comment">// Default</span>

    <span class="token keyword">int</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token keyword">int</span> minutesWorked<span class="token punctuation">,</span> <span class="token keyword">int</span> payRate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> payType<span class="token punctuation">.</span><span class="token function">pay</span><span class="token punctuation">(</span>minutesWorked<span class="token punctuation">,</span> payRate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// The strategy enum type</span>
    <span class="token keyword">private</span> <span class="token keyword">enum</span> <span class="token class-name">PayType</span> <span class="token punctuation">{</span>
        WEEKDAY <span class="token punctuation">{</span>
            <span class="token keyword">int</span> <span class="token function">overtimePay</span><span class="token punctuation">(</span><span class="token keyword">int</span> minsWorked<span class="token punctuation">,</span> <span class="token keyword">int</span> payRate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> minsWorked <span class="token operator">&lt;=</span> MINS_PER_SHIFT <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span>
                  <span class="token punctuation">(</span>minsWorked <span class="token operator">-</span> MINS_PER_SHIFT<span class="token punctuation">)</span> <span class="token operator">*</span> payRate <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        WEEKEND <span class="token punctuation">{</span>
            <span class="token keyword">int</span> <span class="token function">overtimePay</span><span class="token punctuation">(</span><span class="token keyword">int</span> minsWorked<span class="token punctuation">,</span> <span class="token keyword">int</span> payRate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> minsWorked <span class="token operator">*</span> payRate <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">abstract</span> <span class="token keyword">int</span> <span class="token function">overtimePay</span><span class="token punctuation">(</span><span class="token keyword">int</span> mins<span class="token punctuation">,</span> <span class="token keyword">int</span> payRate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MINS_PER_SHIFT <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token keyword">int</span> minsWorked<span class="token punctuation">,</span> <span class="token keyword">int</span> payRate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> basePay <span class="token operator">=</span> minsWorked <span class="token operator">*</span> payRate<span class="token punctuation">;</span>
            <span class="token keyword">return</span> basePay <span class="token operator">+</span> <span class="token function">overtimePay</span><span class="token punctuation">(</span>minsWorked<span class="token punctuation">,</span> payRate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>如果对枚举的 <code>switch</code> 语句不是实现常量特定行为的好选择，那么它们有什么好处呢?枚举类型的 <code>switch</code> 有利于用常量特定的行为增加枚举类型。例如，假设 <code>Operation</code> 枚举不在你的控制之下，你希望它有一个实例方法来返回每个相反的操作。你可以用以下静态方法模拟效果:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Switch on an enum to simulate a missing method</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Operation</span> <span class="token function">inverse</span><span class="token punctuation">(</span><span class="token class-name">Operation</span> op<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>op<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> PLUS<span class="token operator">:</span>   <span class="token keyword">return</span> <span class="token class-name">Operation</span><span class="token punctuation">.</span>MINUS<span class="token punctuation">;</span>
        <span class="token keyword">case</span> MINUS<span class="token operator">:</span>  <span class="token keyword">return</span> <span class="token class-name">Operation</span><span class="token punctuation">.</span>PLUS<span class="token punctuation">;</span>
        <span class="token keyword">case</span> TIMES<span class="token operator">:</span>  <span class="token keyword">return</span> <span class="token class-name">Operation</span><span class="token punctuation">.</span>DIVIDE<span class="token punctuation">;</span>
        <span class="token keyword">case</span> DIVIDE<span class="token operator">:</span> <span class="token keyword">return</span> <span class="token class-name">Operation</span><span class="token punctuation">.</span>TIMES<span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AssertionError</span><span class="token punctuation">(</span><span class="token string">&quot;Unknown op: &quot;</span> <span class="token operator">+</span> op<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>如果某个方法不属于枚举类型，则还应该在你控制的枚举类型上使用此技术。 该方法可能需要用于某些用途，但通常不足以用于列入枚举类型。</p> <p>一般而言，枚举通常在性能上与 <code>int</code> 常数相当。 枚举的一个小小的性能缺点是加载和初始化枚举类型存在空间和时间成本，但在实践中不太可能引人注意。</p> <p>那么你应该什么时候使用枚举呢？ 任何时候使用枚举都需要一组常量，这些常量的成员在编译时已知。 当然，这包括“天然枚举类型”，如行星，星期几和棋子。 但是它也包含了其它你已经知道编译时所有可能值的集合，例如菜单上的选项，操作代码和命令行标志。 <strong>一个枚举类型中的常量集不需要一直保持不变</strong>。 枚举功能是专门设计用于允许二进制兼容的枚举类型的演变。</p> <p>总之，枚举类型优于 <code>int</code> 常量的优点是令人信服的。 枚举更具可读性，更安全，更强大。 许多枚举不需要显式构造方法或成员，但其他人则可以通过将数据与每个常量关联并提供行为受此数据影响的方法而受益。 使用单一方法关联多个行为可以减少枚举。 在这种相对罕见的情况下，更喜欢使用常量特定的方法来枚举自己的值。 如果一些（但不是全部）枚举常量共享共同行为，请考虑策略枚举模式。</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/chenjianyao/OnJava8/edit/master/docs/100.书籍/110.Effective Java/34. 使用枚举类型替代整型常量.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/02/11, 17:35:12</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/OnJava8/pages/299d7f/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">优先考虑类型安全的异构容器</div></a> <a href="/OnJava8/pages/5d9e49/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">使用实例属性替代序数</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/OnJava8/pages/299d7f/" class="prev">优先考虑类型安全的异构容器</a></span> <span class="next"><a href="/OnJava8/pages/5d9e49/">使用实例属性替代序数</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/OnJava8/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/OnJava8/pages/95cf89/"><div>
            Effective Java
            <!----></div></a> <span class="date">03-03</span></dt></dl><dl><dd>02</dd> <dt><a href="/OnJava8/pages/1991bd/"><div>
            Java编程思想
            <!----></div></a> <span class="date">03-03</span></dt></dl><dl><dd>03</dd> <dt><a href="/OnJava8/pages/0e5c0a/"><div>
            Game Hack
            <!----></div></a> <span class="date">03-03</span></dt></dl> <dl><dd></dd> <dt><a href="/OnJava8/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>Smile | <a href="https://github.com/chenjianyao/OnJava8/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/OnJava8/assets/js/app.bd93526c.js" defer></script><script src="/OnJava8/assets/js/2.e7971354.js" defer></script><script src="/OnJava8/assets/js/86.e2c729bd.js" defer></script>
  </body>
</html>
